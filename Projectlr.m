clear;
traindata = importdata('traindata.txt');
X = traindata(:,1:8);
Y = traindata(:,9);
Z = CreaterootFeatures(X,5);
n = length(Y);
c = cvpartition(n,'HoldOut',0.3);
idxTrain = training(c,1);
idxTest = ~idxTrain;
XTrain = Z(idxTrain,:);
yTrain = Y(idxTrain);
XTest = Z(idxTest,:);
yTest = Y(idxTest);
[B,FitInfo] = lasso(XTrain,yTrain,'DFmax',15);
idxLambdaMinMSE = 1;
coef = B(:,idxLambdaMinMSE);
coef0 = FitInfo.Intercept(idxLambdaMinMSE);
k = find(coef);
Z_new = XTest(:,k);
w = coef(k);
training_error = sum((yTest-Z_new*w-coef0).^2)/926;